/** ===========================================================================
 * Flow.js | a jQuery plugin - v1.0.0
 * Copyright 2013 Ry Racherbaumer
 * http://rygine.com/projects/flow.js
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== **/(function(e,t,n,r){"use strict";var i=function(){var e=n.body||n.documentElement,t={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",MsTransition:"MSTransitionEnd",OTransition:"oTransitionEnd otransitionend"},i;for(i in t)if(e.style[i]!==r)return t[i];return!1}(),s=function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}(),o=function(t,n){this.$element=e(t),this.options=n,this.flowing=!1;var r=this;this.$element.attr("tabindex",0).keydown(function(e){switch(e.which){case 37:r.prev();break;case 39:r.next();break;default:return}e.preventDefault()}),this.init()};o.prototype={init:function(){function r(){n._calibrate(),n.$element.trigger("init"),n.to(n.options.start),e(t).resize(function(){s(function(){n._calibrate.call(n),n.go(e(".item.active",n.$element),!0)},100)})}var n=this;e.fn.imagesLoaded?(this.$element.addClass("init"),this.$element.imagesLoaded(function(){n.$element.removeClass("init"),r()})):r()},_calibrate:function(){var t=0;e(".item",this.$element).each(function(){t+=e(this).outerWidth(!0)}),e(".flow-inner",this.$element).width(t)},next:function(){return this.flowing?this:this.go("next")},prev:function(){return this.flowing?this:this.go("prev")},to:function(t){--t;var n=this.$element.find(".item"),r=n.filter(".active"),i=n.index(r),s=this;return t>n.length-1||t<0?this:this.flowing?this.$element.one("flowed",function(){s.to(t)}):i==t?this:this.go(e(n[t]))},go:function(t,n){if(this.flowing)return this;n=typeof n=="undefined"?!1:n;var r=this.$element.find(".flow-inner"),s=this.$element.find(".item"),o=s.filter(".active"),u=s.index(o),a=typeof t=="string"?o[t]():t,f=s.index(a),l=typeof t=="string"?t:u==-1&&f==-1||f>u?"next":"prev",c=l=="next"?"first":"last",h=this,p=function(t,n,r){if(!this.flowing)return;this.flowing=!1;var i=e.Event("flowed",{relatedTarget:n[0],relatedIndex:s.index(n)});this.$element.trigger(i)};a=a&&a.length?a:s[c]();if(!n&&a.hasClass("active"))return this;var d=e.Event("flow",{relatedTarget:a[0],relatedIndex:s.index(a[0])});this.$element.trigger(d);if(d.isDefaultPrevented())return this;this.flowing=!0;var v=(this.$element.outerWidth()-a.outerWidth())/2-a.position().left;return o.removeClass("active"),a.addClass("active"),i?(r.css("left",v),this.$element.one(i,function(){if(!o.length)return;p.call(h,o,a,l)}),setTimeout(function(){p.call(h,o,a,l)},this.options.speed)):r.animate({left:v},this.options.speed,function(){p.call(h,o,a,l)}),this}},e.fn.flow=function(t){var n=arguments;return this.each(function(){var r=e(this),i=r.data("flowjs"),s=e.extend({},e.fn.flow.defaults,typeof t=="object"&&t),u=typeof t=="string"?t:t.flow,a=t.args||n.length>1&&Array.prototype.slice.call(n,1);i||r.data("flowjs",i=new o(this,s)),typeof t=="number"?i.to(t):u&&(u!=="init"||u!=="_calibrate")&&(a?i[u].apply(i,a.length?a:(""+a).split(",")):i[u]())})},e.fn.flow.defaults={start:1,speed:500},e.fn.flow.Contructor=o,e(function(){e("body").on("click.flow","[data-flow]",function(t){var n=e(this);if(["go","init","_calibrate"].indexOf(n.data("flow"))!==-1)return;var r,i=e(n.data("target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data());i.flow(s),t.preventDefault()}),e('[data-flow="init"]').each(function(){var t=e(this);t.flow(t.data())})})})(jQuery,window,document);